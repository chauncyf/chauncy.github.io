---
layout: default
title: Photos
permalink: /photos
---

<script>
    let progressbar = (function () {
        let total;
        let loaded = 0;
        $(() => {
            total = $('.card-columns img').length;
        });

        $(window).on('load', () => {
            progressbar.hide();
        });

        return {
            update: () => {
                $('#progressbar .progress-bar').css('width', `${++loaded * 100 / total}%`);
            },
            hide: () => {
                $('#progressbar').fadeOut(1000);
            }
        }
    })();
</script>

{% include cover.html title="Photography" img="../assets/DSC01881C.jpg" %}

<div class="progress" id="progressbar">
    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"></div>
</div>

<div class="container-fluid container-fade-in my-4">
    <div class="card-columns">

        {% assign images = site.static_files | where: "image", true | where_exp: "image", "image.basename !=
        'sanfrancisco'" %}
        {% for image in images %}

        <div class="card mb-3 shadow-sm" id="{{ image.basename }}"
             onclick="open_modal('{{ image.basename }}', '{{ image.path }}')">
            <img src="{{ image.path }}" class="card-img" alt="{{ image.basename }}" onload="progressbar.update()">
            <div class="mask">
                <div class="card-img-overlay">
                    <p class="card-text">{{ image.basename }}</p>
                </div>
            </div>
        </div>

        {% endfor %}
    </div>
</div>

<div class="modal fade" id="modal-img" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-pic" role="document">
        <div class="modal-content">
            <div class="modal-body p-0">
                <img class="img-fluid" src="" alt="">
                <div class="card-img-nav">
                    <div class="row align-items-center">
                        <div class="col pl-4">
                            <button type="button" class="btn" onclick="prev_pic()">
                                <i class="fas fa-chevron-left"></i></button>
                        </div>
                        <div class="col pr-4 text-right">
                            <button type="button" class="btn" onclick="next_pic()">
                                <i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>
                <div class="card-img-overlay">
                    <p class="card-text"></p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let $modal = $('#modal-img');
    let $modal_img = $('#modal-img img');
    let img_loaded = false;

    function render_img(img_name, img_path, out = 200) {
        img_loaded = false;
        $modal_img.fadeOut(out, () => {
            $modal_img.attr({'src': img_path, 'alt': img_name})
        }).fadeIn(500);
        $('#modal-img p').text(img_name);

        return $.Deferred((d) => {
            $modal_img.on('load', () => {
                img_loaded = true;
                d.resolve()
            })
        }).promise();
    }

    function open_modal(img_name, img_path) {
        if ($(window).width() >= 768) {
            render_img(img_name, img_path, 0).done(() => {
                $modal.modal('show');
            });
        }
    }

    function prev_pic() {
        let $new_image = $('#' + $modal_img.attr('alt')).prev().find('img');
        if ($new_image.length !== 0) {
            render_img($new_image.attr('alt'), $new_image.attr('src'));
        }
    }

    function next_pic() {
        let $new_image = $('#' + $modal_img.attr('alt')).next().find('img');
        if ($new_image.length !== 0) {
            render_img($new_image.attr('alt'), $new_image.attr('src'));
        }
    }

    $(document).keydown(function (e) {
        if (($modal.data('bs.modal') || {})._isShown && img_loaded) {
            e.preventDefault();  // prevent the default action (scroll / move caret)
            switch (e.which) {
                case 37:  // left
                    prev_pic();
                    break;
                case 39:  // right
                    next_pic();
                    break;
                default:
                    return;  // exit this handler for other keys
            }
        }
    });
</script>